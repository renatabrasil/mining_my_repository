{% extends "base.html" %}
{% load contributions_extra %}

{% block title %}Detalhes dos commits{% endblock %}

{% block content %}
<h3>Commits por diret√≥rios</h3>

<div class="float-right">
    <a class="btn btn-primary" href="{{request.path}}to_csv"><i class="fas sm fa-arrow-alt-circle-down"></i> Exportar para CSV</a>
</div>
<div class="table-responsive">
    <table class="table table-striped table-sm">
        <thead>
            <tr>
                <th></th>
                <th>Committer</th>
                <th style="text-align:right"># de commits</th>
                <th style="text-align:right"># de .java commitados</th>
                <th style="text-align:right">% Contribuicao (commits)</th>
                <th style="text-align:right">% Contribuicao (arquivos)</th>
            </tr>
        </thead>
        <tbody>
            {% if latest_commit_list %}
                {% for directory,infos in latest_commit_list.items %}
                    <tr class="p-3 mb-2 bg-secondary text-white">
                        <td colspan="7"><strong>{{directory}}</strong></td>
                    </tr>

                    {% for committer,info in infos.0.items %}
                    <tr >
                        <td>{{forloop.counter}}</td>
                        <td><a href="{{request.path}}developers/{{committer.pk}}?path={{directory}}">{{committer.name}}</a> </td>
                        <td style="text-align:right"> {{info|get:0|length}}</td>
                        <td style="text-align:right"> {{info|get:1}}</td>
                        <td style="text-align:right">{{info|get:0|length|div:infos.1|percentage}}</td>
                        <td style="text-align:right">{{info|get:1|div:infos.2|percentage}}</td>
                    </tr>
                    {% endfor %}
                    <tr class="p-3 mb-2 bg-info text-white">
                        <th colspan="2">Total:</th>
                        <th style="text-align:right">{{infos.1}}</th>
                        <th style="text-align:right">{{infos.2}}</th>
                        <td></td>
                        <td></td>
                    </tr>
                {% endfor %}
            {% else %}
                <tr>
                    <td colspan="3" style="text-align:center;">No commits are available.</td>
                </tr>
            {% endif %}

        </tbody>
{% endblock %}